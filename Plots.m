clear;
close all;

set(0,'defaultfigurecolor','w');

x_min = 0;
x_max = 50;


LW_0 = 1.0;
LW_1 = 3.0;
LW_2 = 4.0;
FS = 40;
MS = 8;

res = 300;
figure_width = 1000;
figure_height = 600;

CLR_1 = [0.0 0.0 0.8];
CLR_2 = [1.0 0.0 0.0];
CLR_3 = [0.0 0.8 0.2];
    figure (1)

    Y_min = -60;
    Y_max = 350;
    force=[0.00506429799935404 0.00395441199992774 -1.00475881299985;
   -0.0067403329998114714 0.0063908650005828349 -1.0025222389992905;
   0.060741780000171275 0.049389161998988129 -1.0344707639992521;
   0.0041026629997986674 -0.0044827090012518056 -1.9350233770003911;
   -6.250341377000268 -31.048111225999719 -86.067155919999976;
   -137.72599420399922 -8.431822769000064 167.154691387;
   -91.919525486999873 -1.6535547239998891 76.994682435000243;
   -44.157411099000228 12.181178167000496 -26.450249319999784;
   -84.839983393999361 143.91361323599932 78.868586161999588;
   2.3151347380000118 -17.827963212000668 203.96826603999989;
   -28.396530903999974 40.14620547400056 131.66177528600008;
   -9.528230901000029 -80.980033165000009 511.1816761000008;
   155.54240581300022 -207.94873845499933 383.19779086500148;
   -56.69789677600042 -101.60478669199956 98.831291541999974;
   25.801509857000269 88.395848723000029 110.89802542599998;
   45.602622725999311 -121.94833515199997 -112.53066912800006;
   -26.222145202999968 128.50804993599934 365.5518057139991;
   -1.2573090160007965 -13.907650243999882 150.61451903500063;
   107.56825157899999 190.30964027599987 223.647730282;
   -103.79562305299805 112.89355347700132 203.61515738200035;
   74.687629644000424 10.879837361000313 95.102234085999953;
   82.292114073999642 -61.695430026000622 305.74903642899926;
   290.87809880799955 -281.35144654499982 578.75523883499977;
   110.29554361200076 386.06312939300005 208.87410158199941;
   169.67827793299978 98.7746607479998 381.51767717400054;
   110.49447985100051 163.8278798189998 340.19714812100034;
   1.9402968609999789 -19.015500136999549 424.73491065499968;
   219.72311317499987 120.48888835800017 363.65283806199994;
   136.91554172699938 55.229505022000694 510.79488919400012;
   345.15093288600053 103.17632196500051 398.84249230500046;
   108.01066949100039 -83.796568335000046 315.76825492000063;
   127.03223157800011 -295.56120244900006 442.97936592400004;
   49.759449923000432 113.70112815199985 365.49911188000033;
   143.17625541799993 -260.329593416001 664.33528126099975;
   36.820584281000066 264.59318584399932 475.65359141000044;
   -128.16022895700041 189.11933085400005 201.11087730000111;
   280.70578880599953 -432.25369813599968 824.32513160700023;
   32.611856328000158 128.16842390599982 874.24673642699963;
   -14.318735780999532 -9.0379452560000573 572.5966065450001;
   377.45695456800013 -154.03845435399978 504.97639162;
   -16.785031454999171 -9.2437693600001012 1152.7712134699998;
   -318.21094633800129 -260.15886009900066 727.30410746700011;
   236.78774092700047 -263.56872029599987 1598.8523410969997;
   -58.001937581000462 165.66463988500072 1401.3515339990004;
   219.73502659899964 -281.0069735699999 2261.315106315;
   86.327767681999973 -33.916631288999888 2421.9070563729997;
   -394.35598179799979 117.88249520199977 3111.8941754160005;
   670.85505314199986 -31.875256065999338 4538.3095619939995;
   -243.02805452900006 316.76254603999905 3913.446009394997;
   37.3678786989999 -1224.3672429039996 4950.1400476550007;
   -139.1080579890002 -1296.2464468209992 6860.4499620150027;
   -456.79367838400071 58.081940326000108 6116.7254508709993;
   2071.6694767799991 -270.91925077599876 6436.2199765029973;
   1042.2892934450017 -176.26583075200023 5839.5874674680017;
   685.38017491800269 -468.16835747100089 6773.495147173;
   574.71943268899975 -155.18146016900113 4604.8611783729975;
   47.452047774000221 1045.3857366320012 4555.0818643819994;
   769.74845152500006 -232.88305893200027 3902.5608347000016;
   1607.0727150159994 1227.2401991319996 3799.764845856;
   739.72309008500088 -135.5930256370001 5371.8388744360009;
   -729.52958701099988 278.59282400999973 5076.8459198329992;
   921.43873053200014 6.6099571839998816 3748.1767104110008;
   -211.56270233699945 560.95755042699921 3502.932226109001;
   198.42964744499938 122.80229639200002 3841.7202270340008;
   609.07985681299965 251.78230530500184 3756.407583153;
   -743.80497489099969 -14.119604912999989 3161.7111057179991;
   -89.66489385199975 173.17940678400029 3368.3192669020009;
   -220.69637863199998 258.21081112600007 2145.0774654019992;
   -573.900137162 129.29974937699978 1945.5421887419991;
   -155.04779074100003 -267.1464466289998 2046.8959844249994;
   -251.58983796699965 -243.15645445600029 2049.6824417710004;
   -894.23766402300009 87.047201351999817 2491.5904176689996;
   45.5929856879999 -242.83659675700042 2400.9338504489997;
   -17.974080655000137 109.43244967800035 2108.357956529;
   -227.49010220699972 645.19612449800013 2071.5736096830005;
   -316.823013137 458.30106076800018 1584.9476213120006;
   -255.76528368400022 -19.467367722000205 1564.2317072079995;
   115.13118408600002 106.51155269599988 1718.7209134339998;
   -253.07525318100014 8.1555575490002354 1512.341048707;
   -225.75044738799988 -461.805439863 1652.5704980060004;
   -510.85003596599972 -407.82760823700005 1607.7644947499998;
   -316.80858045600013 -3.6362469740000449 1508.9314464180004;
   13.2024604429999 -75.760440341000049 1908.4025957599997;
   309.12813515399984 -105.60647245999999 1304.529626476;
   -220.916146727 -234.56459059000002 1426.0296685130002;
   416.89511507300006 827.588949172 1535.9718935109995;
   146.02611713300007 -268.74878921999994 1042.2791844619996;
   116.24888033799986 113.573615183 1647.498525108;
   267.75050823999976 431.16433632999997 1479.001564365;
   -209.32703150099988 409.81314004800004 1382.550992214;
   261.7932570979998 271.49119496899993 1165.792316567;
   109.53464299300002 58.086932260000118 1288.3282793859998;
   -211.21808677400006 102.31397696700012 1231.3592442069998;
   148.48679731999994 -324.286898631 1286.5329958350005;
   -8.7384046879996617 155.11745168000004 978.350080518001;
   79.379533506000087 -327.01304091300005 1418.8314222579997;
   66.769003172000012 -39.497769061999804 1176.9953956840004;
   -42.017822134999996 -146.85599377600005 980.25830048000057;
   -176.20042829300002 -363.77761323100003 1170.1538671619999;
   -159.09366115999995 145.12814586000019 1420.2102263259997;
   -294.693485561 31.225500662000087 1313.7150934099996];
    displacement=[0 0 0;
   -0.0014323322683793549 -0.016977092651760728 0.48742276357827308;
   -0.00065129392970675326 -0.03226782747603707 1.2832192651757168;
   -0.00021436102237260002 -0.047306469648564331 2.1013494089456977;
   -0.00097138977636745949 -0.060866916932912574 2.8946462939297213;
   -0.0061922683706114867 -0.073967268370608963 3.6653025878594292;
   -0.0097207827476069042 -0.088964776357833841 4.3917361182108685;
   -0.013471261980846805 -0.10434777955272168 5.07076389776358;
   -0.021038881789138486 -0.11210782747604853 5.7122413099041509;
   -0.034350287539943736 -0.10616666134185593 6.3160746325878705;
   -0.042455670926521805 -0.091882476038346539 6.8539576357827556;
   -0.045457955271572814 -0.069586869009590657 7.3311532268370669;
   -0.046455638977647595 -0.041009696485623692 7.7308398402555909;
   -0.047540255591073333 0.0081858945686903439 8.0543969169329017;
   -0.044181964856235822 0.087591661341846816 8.31587252396168;
   -0.043052252396172719 0.16809522364216178 8.55419397763579;
   -0.038740926517576213 0.24721134185302773 8.7807973322683637;
   -0.026965159744406719 0.310975942492 8.9970534664536714;
   0.0038679872204454568 0.353876948881787 9.2110472204472913;
   0.060214392971246866 0.36598372204472795 9.52020942492014;
   0.15040028753993795 0.34522329073482183 10.049265031948892;
   0.2711040255591044 0.3183688338658115 10.63792642172524;
   0.38720169329072718 0.31687626198081986 11.135184201277958;
   0.48453311501597796 0.30733182108625812 11.538235479233229;
   0.57762471246005731 0.28814055910543246 11.982489169329071;
   0.653807460063895 0.24917876996804367 12.495356070287542;
   0.73647423322682926 0.181309712460056 13.016657012779575;
   0.80621357827475748 0.12757054313097882 13.500932124600638;
   0.87686607028751951 0.072638051118200764 14.012049249201283;
   0.93269257188499211 0.038961661341851084 14.503596533546336;
   0.945347763578269 0.041104185303503016 15.030232875399371;
   0.949434728434511 0.088347939297118927 15.534196198083059;
   0.95163164536739941 0.18916960063897292 15.982358162939285;
   0.97847825878594108 0.32255634185303705 16.468197300319495;
   1.0107983706070343 0.46934335463257781 16.992030319488826;
   1.0603347923322701 0.5879870447284361 17.446439552715653;
   1.0951572683706061 0.63646305111820922 17.933613338658162;
   1.1596247124600652 0.71095661341852079 18.41047474440893;
   1.2182493450479157 0.79283680511181842 18.915721357827493;
   1.2723691214057382 0.8750699840255507 19.385663626198102;
   1.2756731469648486 0.96278926517571861 19.850533194888172;
   1.2582966453674231 1.0163139297124495 20.302904153354639;
   1.249396214057505 1.0427306230031768 20.768403226837066;
   1.2373529712460112 1.0525520926517515 21.206503594249206;
   1.25192063897763 1.0617671086261957 21.609592252396162;
   1.2955981469648563 1.0412249680511145 21.980772076677319;
   1.2960026357827275 0.964276853035134 22.360369568690103;
   1.2383888658146844 0.90363432907347629 22.735497412140582;
   1.2035160223641981 0.88150477635782565 23.191933370607032;
   1.1908345846645432 0.83855466453672634 23.677946038338654;
   1.1879470287539888 0.79564623003194868 24.047349536741223;
   1.2283493450479241 0.761966070287535 24.331981469648568;
   1.2443823961661309 0.71190565495207636 24.608659552715665;
   1.2547963897763381 0.65569217252395262 25.040989121405765;
   1.2348130191693372 0.66037265175719284 25.601710159744421;
   1.2022801277955182 0.68803651757188078 26.16510822683707;
   1.2094538338658083 0.777298322683702 26.856612028753993;
   1.2251507827476047 0.77483706070286829 27.514214904153349;
   1.2193773642172445 0.77318134185303222 28.039412731629398;
   1.2470258146964781 0.8122549840255644 28.462289201277954;
   1.2627964536741132 0.87261193290733274 28.966744057508002;
   1.3271134824281177 0.918777555910534 29.543139840255584;
   1.3265163418530292 0.94801169329073431 30.102600862619802;
   1.3181760543131062 0.957501869009576 30.638603290734835;
   1.2759956869009557 0.98483253993609665 31.172230670926538;
   1.2227693610223582 1.0079268530351264 31.67346995207668;
   1.1875211501597462 0.99021706070287507 32.196603258785927;
   1.1853223162939273 0.94811669329073212 32.717633402555919;
   1.1799005111821046 0.93777127795526383 33.2197114536741;
   1.1715541373801841 0.96015180511180631 33.728535319488827;
   1.1251487859424927 0.98276039936101967 34.274584392971249;
   1.0646778913737975 1.0060873003194857 34.797395974440882;
   0.99756777955271758 1.0229536102236345 35.301901405750804;
   0.93502718849838828 1.0340819488817843 35.813721453674134;
   0.89793052715653943 1.0591439297124552 36.335298530351444;
   0.86316461661341037 1.0715661661341827 36.84919060702876;
   0.81544282747604768 1.0769374121405697 37.354847284345048;
   0.75715968051117244 1.0685282268370528 37.860445063897785;
   0.69547408945686584 1.0531322364217246 38.366993115016;
   0.621762619808294 1.0402946645367379 38.874211277955268;
   0.5546178913738018 1.0404532108626086 39.369852060702868;
   0.508900926517569 1.0483786261980796 39.859020926517573;
   0.46675258785941764 1.0420273322683613 40.3753862460064;
   0.41429389776356373 1.02973030351437 40.883077300319471;
   0.36231196485622519 1.0181717092651716 41.390101246006395;
   0.33185456869009755 1.0089257667731459 41.887527444089471;
   0.31459348242811558 0.9896941214057442 42.392164760383366;
   0.288846613418535 0.97581428115014646 42.897592523961663;
   0.27202477635782429 0.96238135782747136 43.403013099041544;
   0.23449835463259205 0.96158001597443032 43.896988003194892;
   0.19839440894569549 0.94899533546325543 44.402977284345042;
   0.15869083067091339 0.93397514376995261 44.904894520766788;
   0.11610888178913825 0.92234801916933407 45.409555638977665;
   0.093833785942493364 0.91516541533545848 45.9108990734824;
   0.080013753993618764 0.91128075079871707 46.416813913738039;
   0.055498961661342605 0.91355567092651313 46.909690271565481;
   0.012925143769962233 0.90943982428115433 47.399859073482432;
   -0.023287428115011721 0.89139317891374148 47.902555798722048;
   -0.049365399361029461 0.87658332268370032 48.413658690095843;
   -0.072673769968055524 0.86360408945685307 48.921113578274756;
   -0.099647140575090276 0.85839944089455855 49.415860127795526];
    plot(displacement,force*0.04184, '-', 'Color', CLR_1, 'LineWidth', LW_2, ...
       'MarkerEdgeColor', CLR_1, 'MarkerFaceColor', 'none', 'MarkerSize', MS); hold on;
    %{
    plot(data2(:,1)/10000, data2(:,4), '-', 'Color', CLR_2, 'LineWidth', LW_2, ...
       'MarkerEdgeColor', CLR_1, 'MarkerFaceColor', 'none', 'MarkerSize', MS); hold on;
     plot(data3(:,1)/10000, data3(:,4), '-', 'Color', CLR_3, 'LineWidth', LW_2, ...
       'MarkerEdgeColor', CLR_1, 'MarkerFaceColor', 'none', 'MarkerSize',
       MS); hold on;
    %}
    box on;
    xlim([x_min x_max]);
    xticks(x_min:(x_max-x_min)/20:x_max);
    xticklabels({'0', '', '5', '', '10', '', '15', '', '20', '', '25', '', ...
                   '30', '', '35', '', '40', '', '45', '', '50'});
    xtickangle(0);


    ylim([Y_min Y_max]);
    yticks(Y_min:(Y_max-Y_min)/5:Y_max);
    legend('Trial 1: 0.5 Å/ps', 'Trial 2: 1.0 /ps', 'Trial 3: 2.0 /ps','Location', 'NorthEast');
    fontsize(legend,17,'points')
    title('Force vs Displacement');
    
    

    
    set(gca,'XGrid','off'); 
    
    set(gca,'GridLineStyle',':');
    set(gca,'LineWidth', LW_0, 'FontSize', FS-25, 'FontWeight', 'normal', 'FontName', 'Calibri');
    set(get(gca, 'xlabel'), 'String', 'Displacement(Å)', 'FontSize', FS-20, 'FontName', 'Calibri');
    set(get(gca, 'ylabel'), 'String', 'Force (nN)', 'FontSize', FS-20, 'FontName', 'Times');
    set(gcf, 'Position', [100, 100, 1000, 600]);

    exportgraphics(gcf, 'ForcevsDispTrial1.png', 'Resolution', res, 'ContentType', 'vector');

   